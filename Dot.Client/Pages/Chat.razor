@using Dot.Client.Layout
@page "/chat/{conversationId}"
@layout ChatLayout

<div class="chat-window">
    <PageTitle>Chat</PageTitle>

    <div class="chat-history">
        @foreach(var entry in ChatEntries)
        {
            <div class="chat-bubble @(entry.IsUser ? "user" : "assistant")">
                @((MarkupString)entry.Content)
                @if(!string.IsNullOrWhiteSpace(entry.Thought))
                {
                    <button @onclick="() => ToggleThoughtVisibility(entry.Index)">@(entry.IsShowThought ? "Hide Thought" : "Show Thought")</button>
                    <div class="thought @(entry.IsShowThought ? "show" : "hidden")">
                        @((MarkupString)entry.Thought)
                    </div>
                }
            </div><!-- .chat-bubble -->
        }
        
        @if (messages.Any())
        {
            <div id="chat-latest-ai-response" class="chat-bubble assistant">
                @foreach (var message in messages)
                {
                    @((MarkupString)message)
                }
            </div><!-- .chat-latest-ai-response -->
        }
    </div><!-- .chat-history -->

    <div class="chat-input">
        <textarea @bind="messageInput" size="50" />
        <button @onclick="Send" disabled="@(!IsConnected)">Send</button>
    </div><!-- .chat-input -->
</div><!-- .chat-window -->